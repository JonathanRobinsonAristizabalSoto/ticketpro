CREATE TABLE Rol (
    id_rol INT PRIMARY KEY AUTO_INCREMENT,
    nombre_rol VARCHAR(255) NOT NULL,
    descripcion_rol TEXT,
    UNIQUE (nombre_rol)
);

CREATE TABLE Usuarios (
    id_usuario INT PRIMARY KEY AUTO_INCREMENT,
    nombre VARCHAR(255) NOT NULL,
    apellido VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL UNIQUE,
    telefono VARCHAR(20),
    departamento VARCHAR(255),
    municipio VARCHAR(255),
    documento VARCHAR(255) NOT NULL UNIQUE,
    tipo_documento VARCHAR(255) NOT NULL,
    password VARCHAR(255) NOT NULL,
    id_rol INT,
    fecha_registro DATE,
    estado VARCHAR(50),
    FOREIGN KEY (id_rol) REFERENCES Rol(id_rol),
    INDEX (email),
    INDEX (documento)
);

CREATE TABLE Categoria (
    id_categoria INT PRIMARY KEY AUTO_INCREMENT,
    nombre VARCHAR(255) NOT NULL,
    descripcion TEXT,
    UNIQUE (nombre)
);

CREATE TABLE Ticket (
    id_ticket INT PRIMARY KEY AUTO_INCREMENT,
    id_usuario INT,
    titulo VARCHAR(255) NOT NULL,
    descripcion TEXT,
    prioridad VARCHAR(50),
    estado VARCHAR(50),
    id_agente INT,
    fecha_creacion DATE,
    fecha_actualizacion DATE,
    id_categoria INT,
    FOREIGN KEY (id_usuario) REFERENCES Usuarios(id_usuario),
    FOREIGN KEY (id_categoria) REFERENCES Categoria(id_categoria),
    INDEX (id_usuario),
    INDEX (id_categoria)
);

CREATE TABLE Comentario (
    id_comentario INT PRIMARY KEY AUTO_INCREMENT,
    id_ticket INT,
    id_usuario INT,
    comentario TEXT NOT NULL,
    fecha_comentario DATE,
    FOREIGN KEY (id_ticket) REFERENCES Ticket(id_ticket),
    FOREIGN KEY (id_usuario) REFERENCES Usuarios(id_usuario),
    INDEX (id_ticket),
    INDEX (id_usuario)
);

CREATE TABLE Evento (
    id_evento INT PRIMARY KEY AUTO_INCREMENT,
    id_ticket INT,
    accion VARCHAR(255) NOT NULL,
    id_usuario INT,
    fecha_evento DATE,
    FOREIGN KEY (id_ticket) REFERENCES Ticket(id_ticket),
    FOREIGN KEY (id_usuario) REFERENCES Usuarios(id_usuario),
    INDEX (id_ticket),
    INDEX (id_usuario)
);